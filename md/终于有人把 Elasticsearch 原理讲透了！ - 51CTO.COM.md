> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [developer.51cto.com](https://developer.51cto.com/art/201904/594615.htm)

小史是一个非科班的程序员，虽然学的是电子专业，但是通过自己的努力成功通过了面试，现在要开始迎接新生活了。

作者：channingbreeze 来源：[互联网侦察](https://mp.weixin.qq.com/s/dbBtGkFAENv1lbgzqfd4cA) |_2019-04-08 12:14_

小史是一个非科班的程序员，虽然学的是电子专业，但是通过自己的努力成功通过了面试，现在要开始迎接新生活了。

随着央视诗词大会的热播，小史开始对诗词感兴趣，最喜欢的就是飞花令的环节。

[![](https://s4.51cto.com/oss/201904/08/b90f0d97ba26e7a1cb466ae4ddd1ee8e.jpg-wh_651x-s_3709590712.jpg)](https://s4.51cto.com/oss/201904/08/b90f0d97ba26e7a1cb466ae4ddd1ee8e.jpg-wh_651x-s_3709590712.jpg)

[![](https://s3.51cto.com/oss/201904/08/21049165449d86509d73dddd41e1a104.jpg)](https://s3.51cto.com/oss/201904/08/21049165449d86509d73dddd41e1a104.jpg)

但是由于小史很久没有背过诗词了，飞一个字很难说出一句，很多之前很熟悉的诗句也想不起来。

[![](https://s5.51cto.com/oss/201904/08/cff18d625d974aa93722920793787890.jpg)](https://s5.51cto.com/oss/201904/08/cff18d625d974aa93722920793787890.jpg)

[![](https://s4.51cto.com/oss/201904/08/52b92f4707a4f6b312f91d5a046a4cdd.jpg)](https://s4.51cto.com/oss/201904/08/52b92f4707a4f6b312f91d5a046a4cdd.jpg)

[![](https://s3.51cto.com/oss/201904/08/7e88c6b3aaae4bc3b5eaf02c053e274f.jpg)](https://s3.51cto.com/oss/201904/08/7e88c6b3aaae4bc3b5eaf02c053e274f.jpg)

[![](https://s3.51cto.com/oss/201904/08/c5052bf96458871b87cc4281ac3e4bf2.jpg)](https://s3.51cto.com/oss/201904/08/c5052bf96458871b87cc4281ac3e4bf2.jpg)

[![](https://s4.51cto.com/oss/201904/08/35affaf153f200f3ceb7d67442b38d92.jpg)](https://s4.51cto.com/oss/201904/08/35affaf153f200f3ceb7d67442b38d92.jpg)

[![](https://s1.51cto.com/oss/201904/08/6572080a1e6c66519d0d880732709d9d.jpg)](https://s1.51cto.com/oss/201904/08/6572080a1e6c66519d0d880732709d9d.jpg)

[![](https://s3.51cto.com/oss/201904/08/70fc4a07050b97053886f0451ba2cf9e.jpg)](https://s3.51cto.com/oss/201904/08/70fc4a07050b97053886f0451ba2cf9e.jpg)

[![](https://s5.51cto.com/oss/201904/08/a06407e96941a36a3708bf2d8bc8ad11.jpg)](https://s5.51cto.com/oss/201904/08/a06407e96941a36a3708bf2d8bc8ad11.jpg)

[![](https://s5.51cto.com/oss/201904/08/ec8b7e30f14e077a794a0c3679d8a91d.jpg)](https://s5.51cto.com/oss/201904/08/ec8b7e30f14e077a794a0c3679d8a91d.jpg)

[![](https://s5.51cto.com/oss/201904/08/2d7a007f5c9b2647fcb48fa3fc139da3.jpg)](https://s5.51cto.com/oss/201904/08/2d7a007f5c9b2647fcb48fa3fc139da3.jpg)

**倒排索引**

[![](https://s4.51cto.com/oss/201904/08/f5542d390635197c67e9cc1f14d5a31e.jpg)](https://s4.51cto.com/oss/201904/08/f5542d390635197c67e9cc1f14d5a31e.jpg)

[![](https://s4.51cto.com/oss/201904/08/9da0a084151d09e380cb5cf0cb3fd0d7.jpg)](https://s4.51cto.com/oss/201904/08/9da0a084151d09e380cb5cf0cb3fd0d7.jpg)

[![](https://s5.51cto.com/oss/201904/08/5820ca6e9e8e923a966f907781023f39.jpg)](https://s5.51cto.com/oss/201904/08/5820ca6e9e8e923a966f907781023f39.jpg)

[![](https://s1.51cto.com/oss/201904/08/3c63cf1737037b35e9fc0a3f6e656d90.jpg)](https://s1.51cto.com/oss/201904/08/3c63cf1737037b35e9fc0a3f6e656d90.jpg)

[![](https://s2.51cto.com/oss/201904/08/64c9a8ae902873755cf8c6cafa50ea68.jpg)](https://s2.51cto.com/oss/201904/08/64c9a8ae902873755cf8c6cafa50ea68.jpg)

[![](https://s5.51cto.com/oss/201904/08/f7a583e841a2c70c5006e8f9ab0999f5.jpg)](https://s5.51cto.com/oss/201904/08/f7a583e841a2c70c5006e8f9ab0999f5.jpg)

吕老师：但是我让你说出带 “前” 字的诗句，由于没有索引，你只能遍历脑海中所有诗词，当你的脑海中诗词量大的时候，就很难在短时间内得到结果了。

[![](https://s5.51cto.com/oss/201904/08/d0d4382894b2b5c3fb9a48c696c227e0.jpg)](https://s5.51cto.com/oss/201904/08/d0d4382894b2b5c3fb9a48c696c227e0.jpg)

[![](https://s4.51cto.com/oss/201904/08/33ea8f149b1970d0dc3cf00207a8d024.jpg)](https://s4.51cto.com/oss/201904/08/33ea8f149b1970d0dc3cf00207a8d024.jpg)

[![](https://s3.51cto.com/oss/201904/08/67287b4a53fae3634e0ac3a4f4012a73.jpg)](https://s3.51cto.com/oss/201904/08/67287b4a53fae3634e0ac3a4f4012a73.jpg)

[![](https://s2.51cto.com/oss/201904/08/c2838b8bbf2ced0c643f3dc82203ca70.jpg)](https://s2.51cto.com/oss/201904/08/c2838b8bbf2ced0c643f3dc82203ca70.jpg)

[![](https://s2.51cto.com/oss/201904/08/51f05b01e1ad320816e51109ccd68298.jpg)](https://s2.51cto.com/oss/201904/08/51f05b01e1ad320816e51109ccd68298.jpg)

[![](https://s5.51cto.com/oss/201904/08/4efea6d5d85f66abed46965f30a80577.jpg)](https://s5.51cto.com/oss/201904/08/4efea6d5d85f66abed46965f30a80577.jpg)

[![](https://s3.51cto.com/oss/201904/08/02edd981025939f732ec5c7c6e380330.jpg)](https://s3.51cto.com/oss/201904/08/02edd981025939f732ec5c7c6e380330.jpg)

**索引量爆炸**

[![](https://s5.51cto.com/oss/201904/08/5db3356e4d87b22fc65cacef7a1d62e7.jpg)](https://s5.51cto.com/oss/201904/08/5db3356e4d87b22fc65cacef7a1d62e7.jpg)

[![](https://s5.51cto.com/oss/201904/08/f892e90dcc9b14c73aae238a7736e62d.jpg)](https://s5.51cto.com/oss/201904/08/f892e90dcc9b14c73aae238a7736e62d.jpg)

[![](https://s4.51cto.com/oss/201904/08/4f47fce7cfa2f9ef64a43b6f88beec02.jpg)](https://s4.51cto.com/oss/201904/08/4f47fce7cfa2f9ef64a43b6f88beec02.jpg)

[![](https://s1.51cto.com/oss/201904/08/1b5f5b3e6aa8b2cdb2eef309c737a907.jpg)](https://s1.51cto.com/oss/201904/08/1b5f5b3e6aa8b2cdb2eef309c737a907.jpg)

[![](https://s2.51cto.com/oss/201904/08/bc3c83a360c8b782f9326430e192690d.jpg)](https://s2.51cto.com/oss/201904/08/bc3c83a360c8b782f9326430e192690d.jpg)

[![](https://s4.51cto.com/oss/201904/08/7c92c0a59c6d772515be7e29e7a23466.jpg)](https://s4.51cto.com/oss/201904/08/7c92c0a59c6d772515be7e29e7a23466.jpg)

[![](https://s4.51cto.com/oss/201904/08/8644c43c592a84212f811e75dbdf278f.jpg)](https://s4.51cto.com/oss/201904/08/8644c43c592a84212f811e75dbdf278f.jpg)

[![](https://s5.51cto.com/oss/201904/08/b89b766a693b32264a26982036fbd7c9.jpg)](https://s5.51cto.com/oss/201904/08/b89b766a693b32264a26982036fbd7c9.jpg)

[![](https://s4.51cto.com/oss/201904/08/5db41e50f2de32f2478d812f782b8f33.jpg)](https://s4.51cto.com/oss/201904/08/5db41e50f2de32f2478d812f782b8f33.jpg)

[![](https://s5.51cto.com/oss/201904/08/0ba8e5675a0a0e3546fd52b9fd622959.jpg)](https://s5.51cto.com/oss/201904/08/0ba8e5675a0a0e3546fd52b9fd622959.jpg)

[![](https://s1.51cto.com/oss/201904/08/fb20d478340fea364e55cffc79ac2489.jpg)](https://s1.51cto.com/oss/201904/08/fb20d478340fea364e55cffc79ac2489.jpg)

[![](https://s3.51cto.com/oss/201904/08/eeabeb43e65c23edd558aef6a4915f0e.jpg)](https://s3.51cto.com/oss/201904/08/eeabeb43e65c23edd558aef6a4915f0e.jpg)

[![](https://s1.51cto.com/oss/201904/08/cc7eab2a6ccb1d709b4414e54a90753a.jpg)](https://s1.51cto.com/oss/201904/08/cc7eab2a6ccb1d709b4414e54a90753a.jpg)

[![](https://s4.51cto.com/oss/201904/08/ca86d549717bc2d4041ccf77b89721c5.jpg)](https://s4.51cto.com/oss/201904/08/ca86d549717bc2d4041ccf77b89721c5.jpg)

[![](https://s2.51cto.com/oss/201904/08/ad4faa38e443b89dec31a5777c5d06d0.jpg)](https://s2.51cto.com/oss/201904/08/ad4faa38e443b89dec31a5777c5d06d0.jpg)

[![](https://s3.51cto.com/oss/201904/08/78986965914c169a5b985522fe8a8579.jpg)](https://s3.51cto.com/oss/201904/08/78986965914c169a5b985522fe8a8579.jpg)

[![](https://s2.51cto.com/oss/201904/08/573a5ae7f2f61859f228e521ca6c86d8.jpg)](https://s2.51cto.com/oss/201904/08/573a5ae7f2f61859f228e521ca6c86d8.jpg)

[![](https://s2.51cto.com/oss/201904/08/8a605cecdee3765ba4e2a7b8c96a2a75.jpg)](https://s2.51cto.com/oss/201904/08/8a605cecdee3765ba4e2a7b8c96a2a75.jpg)

[![](https://s2.51cto.com/oss/201904/08/f0fdf574418b86a1871fdbc6ab3a7301.jpg)](https://s2.51cto.com/oss/201904/08/f0fdf574418b86a1871fdbc6ab3a7301.jpg)

**搜索引擎原理**

[![](https://s2.51cto.com/oss/201904/08/3da871a6c54837df09d658595ffbed59.jpg)](https://s2.51cto.com/oss/201904/08/3da871a6c54837df09d658595ffbed59.jpg)

[![](https://s5.51cto.com/oss/201904/08/65c5724aa69762eef80b58e52b7c7572.jpg)](https://s5.51cto.com/oss/201904/08/65c5724aa69762eef80b58e52b7c7572.jpg)

[![](https://s1.51cto.com/oss/201904/08/73dad3a56058c0db1ac077263f616062.jpg)](https://s1.51cto.com/oss/201904/08/73dad3a56058c0db1ac077263f616062.jpg)

[![](https://s5.51cto.com/oss/201904/08/93aceb3f291914d7eeefb84dc1ea8807.jpg)](https://s5.51cto.com/oss/201904/08/93aceb3f291914d7eeefb84dc1ea8807.jpg)

[![](https://s2.51cto.com/oss/201904/08/35d000bf31d11eef3177febe71d0419d.jpg)](https://s2.51cto.com/oss/201904/08/35d000bf31d11eef3177febe71d0419d.jpg)

[![](https://s3.51cto.com/oss/201904/08/e393eee16061dc108700ca0f9651b07f.jpg)](https://s3.51cto.com/oss/201904/08/e393eee16061dc108700ca0f9651b07f.jpg)

[![](https://s3.51cto.com/oss/201904/08/b346e955bc21c928cfcf9946ab445528.jpg)](https://s3.51cto.com/oss/201904/08/b346e955bc21c928cfcf9946ab445528.jpg)

[![](https://s5.51cto.com/oss/201904/08/f881573774af982ae2d5434d50c9278e.jpg)](https://s5.51cto.com/oss/201904/08/f881573774af982ae2d5434d50c9278e.jpg)

[![](https://s2.51cto.com/oss/201904/08/f649400f77afb2c2f51f6253a6699a69.jpg)](https://s2.51cto.com/oss/201904/08/f649400f77afb2c2f51f6253a6699a69.jpg)

[![](https://s4.51cto.com/oss/201904/08/ba424785975cde27c300069832ad1f60.jpg)](https://s4.51cto.com/oss/201904/08/ba424785975cde27c300069832ad1f60.jpg)

[![](https://s1.51cto.com/oss/201904/08/4767df311b240f6ce2845116f0f56a74.jpg)](https://s1.51cto.com/oss/201904/08/4767df311b240f6ce2845116f0f56a74.jpg)

[![](https://s2.51cto.com/oss/201904/08/22d4da09a328cb4230c12d506e53c5cb.jpg)](https://s2.51cto.com/oss/201904/08/22d4da09a328cb4230c12d506e53c5cb.jpg)

[![](https://s2.51cto.com/oss/201904/08/35a148c1c1942bb9aea29b043414cca2.jpg)](https://s2.51cto.com/oss/201904/08/35a148c1c1942bb9aea29b043414cca2.jpg)

[![](https://s5.51cto.com/oss/201904/08/a77ee9ea0b83d9ab88cb69abdbd23e39.jpg)](https://s5.51cto.com/oss/201904/08/a77ee9ea0b83d9ab88cb69abdbd23e39.jpg)

[![](https://s2.51cto.com/oss/201904/08/f94d48c202a91f1f0a48ce1832441ec1.jpg)](https://s2.51cto.com/oss/201904/08/f94d48c202a91f1f0a48ce1832441ec1.jpg)

**Elasticsearch 简介**

[![](https://s4.51cto.com/oss/201904/08/3a525e3eda3eafe8666de25c5746c780.jpg)](https://s4.51cto.com/oss/201904/08/3a525e3eda3eafe8666de25c5746c780.jpg)

[![](https://s2.51cto.com/oss/201904/08/fac95dbe3e875fb22e7988090310f9fc.jpg)](https://s2.51cto.com/oss/201904/08/fac95dbe3e875fb22e7988090310f9fc.jpg)

[![](https://s2.51cto.com/oss/201904/08/a51b8c6738ace50e252d3f402ca4a27f.jpg)](https://s2.51cto.com/oss/201904/08/a51b8c6738ace50e252d3f402ca4a27f.jpg)

[![](https://s1.51cto.com/oss/201904/08/fb0bcc29fb72958e323fb12d1f5c7f6c.jpg)](https://s1.51cto.com/oss/201904/08/fb0bcc29fb72958e323fb12d1f5c7f6c.jpg)

[![](https://s4.51cto.com/oss/201904/08/7a067799b711d1996daf58c7f96a66c4.jpg)](https://s4.51cto.com/oss/201904/08/7a067799b711d1996daf58c7f96a66c4.jpg)

吕老师：但是 Lucene 还是一个库，必须要懂一点搜索引擎原理的人才能用的好，所以后来又有人基于 Lucene 进行封装，写出了 Elasticsearch。

[![](https://s3.51cto.com/oss/201904/08/4e5410202a24294d5e21358bb3dbf8ca.jpg)](https://s3.51cto.com/oss/201904/08/4e5410202a24294d5e21358bb3dbf8ca.jpg)

[![](https://s2.51cto.com/oss/201904/08/67d44ab8cc8ef6473561e777cf2ddd34.jpg)](https://s2.51cto.com/oss/201904/08/67d44ab8cc8ef6473561e777cf2ddd34.jpg)

[![](https://s5.51cto.com/oss/201904/08/cb6d9c99f101c60f170179f3b943782f.jpg)](https://s5.51cto.com/oss/201904/08/cb6d9c99f101c60f170179f3b943782f.jpg)

[![](https://s2.51cto.com/oss/201904/08/1054dfc9e0bcd34e2feaf4bfea81197e.jpg)](https://s2.51cto.com/oss/201904/08/1054dfc9e0bcd34e2feaf4bfea81197e.jpg)

[![](https://s5.51cto.com/oss/201904/08/7a8774e38d8c7bbcf6f62d718f13aa1b.jpg)](https://s5.51cto.com/oss/201904/08/7a8774e38d8c7bbcf6f62d718f13aa1b.jpg)

[![](https://s3.51cto.com/oss/201904/08/fc3a491596c74091864f531ab7cdb4b2.jpg)](https://s3.51cto.com/oss/201904/08/fc3a491596c74091864f531ab7cdb4b2.jpg)

**Elasticsearch 基本概念**

[![](https://s3.51cto.com/oss/201904/08/8024406b6d7908bf8c0d02c03f5b98c0.jpg)](https://s3.51cto.com/oss/201904/08/8024406b6d7908bf8c0d02c03f5b98c0.jpg)

[![](https://s2.51cto.com/oss/201904/08/952e2c1d746b0fc4694f7a235a418542.jpg)](https://s2.51cto.com/oss/201904/08/952e2c1d746b0fc4694f7a235a418542.jpg)

[![](https://s2.51cto.com/oss/201904/08/e1257ad9cb1919a9d44ae621ec662f51.jpg)](https://s2.51cto.com/oss/201904/08/e1257ad9cb1919a9d44ae621ec662f51.jpg)

[![](https://s5.51cto.com/oss/201904/08/ec96c8031e8f80c0a3f99ee3e0702557.jpg)](https://s5.51cto.com/oss/201904/08/ec96c8031e8f80c0a3f99ee3e0702557.jpg)

[![](https://s1.51cto.com/oss/201904/08/c969f5edc941291d55e19cdf1ac36899.jpg)](https://s1.51cto.com/oss/201904/08/c969f5edc941291d55e19cdf1ac36899.jpg)

吕老师：类型是用来定义数据结构的，你可以认为是 MySQL 中的一张表。文档就是最终的数据了，你可以认为一个文档就是一条记录。

[![](https://s5.51cto.com/oss/201904/08/3661c22434448b83537f4dc5a99acd97.jpg)](https://s5.51cto.com/oss/201904/08/3661c22434448b83537f4dc5a99acd97.jpg)

[![](https://s5.51cto.com/oss/201904/08/6dbd42d9ad083de66777fdd5887905c7.jpg)](https://s5.51cto.com/oss/201904/08/6dbd42d9ad083de66777fdd5887905c7.jpg)

[![](https://s2.51cto.com/oss/201904/08/28a9739dee095bc60e625afef43d881d.jpg)](https://s2.51cto.com/oss/201904/08/28a9739dee095bc60e625afef43d881d.jpg)

吕老师：比如一首诗，有诗题、作者、朝代、字数、诗内容等字段，那么首先，我们可以建立一个名叫 Poems 的索引，然后创建一个名叫 Poem 的类型，类型是通过 Mapping 来定义每个字段的类型。

比如诗题、作者、朝代都是 Keyword 类型，诗内容是 Text 类型，而字数是 Integer 类型，*** 就是把数据组织成 Json 格式存放进去了。

[![](https://s4.51cto.com/oss/201904/08/b87268bbe90f5ee8ff479248cc01282e.jpg)](https://s4.51cto.com/oss/201904/08/b87268bbe90f5ee8ff479248cc01282e.jpg)

[![](https://s2.51cto.com/oss/201904/08/15729b343f87f134ca7c8f3bd5dc54b8.jpg)](https://s2.51cto.com/oss/201904/08/15729b343f87f134ca7c8f3bd5dc54b8.jpg)

[![](https://s1.51cto.com/oss/201904/08/6cde1d300628c3ad9458d62fa81700b5.jpg)](https://s1.51cto.com/oss/201904/08/6cde1d300628c3ad9458d62fa81700b5.jpg)

吕老师：这个问题问得好，这涉及到分词的问题，Keyword 类型是不会分词的，直接根据字符串内容建立反向索引，Text 类型在存入 Elasticsearch 的时候，会先分词，然后根据分词后的内容建立反向索引。

[![](https://s1.51cto.com/oss/201904/08/8e57aed5bca916051547e019ccd8e81f.jpg)](https://s1.51cto.com/oss/201904/08/8e57aed5bca916051547e019ccd8e81f.jpg)

[![](https://s5.51cto.com/oss/201904/08/4e5494306dc11e691e227f86d9ee6ef9.jpg)](https://s5.51cto.com/oss/201904/08/4e5494306dc11e691e227f86d9ee6ef9.jpg)

[![](https://s1.51cto.com/oss/201904/08/3391016d936bc6f696a9cb9b5ecbbe9c.jpg)](https://s1.51cto.com/oss/201904/08/3391016d936bc6f696a9cb9b5ecbbe9c.jpg)

吕老师：之前我们说过，Elasticsearch 把操作都封装成了 HTTP 的 API，我们只要给 Elasticsearch 发送 HTTP 请求就行。

比如使用 curl -XPUT 'http://ip:port/poems'，就能建立一个名为 Poems 的索引，其他操作也是类似的。

[![](https://s5.51cto.com/oss/201904/08/e9660e5da629f4da646a3435e888c0fe.jpg)](https://s5.51cto.com/oss/201904/08/e9660e5da629f4da646a3435e888c0fe.jpg)

**Elasticsearch 分布式原理**

[![](https://s5.51cto.com/oss/201904/08/4147feb79d320c5139f400ca72193dca.jpg)](https://s5.51cto.com/oss/201904/08/4147feb79d320c5139f400ca72193dca.jpg)

[![](https://s3.51cto.com/oss/201904/08/0379a0a19b078a07ae16556d56dc6001.jpg)](https://s3.51cto.com/oss/201904/08/0379a0a19b078a07ae16556d56dc6001.jpg)

吕老师：没错，Elasticsearch 也是会对数据进行切分，同时每一个分片会保存多个副本，其原因和 HDFS 是一样的，都是为了保证分布式环境下的高可用。

[![](https://s5.51cto.com/oss/201904/08/67cc045d0442c8f1c2990be9589abf75.jpg)](https://s5.51cto.com/oss/201904/08/67cc045d0442c8f1c2990be9589abf75.jpg)

[![](https://s2.51cto.com/oss/201904/08/791e10e8c82ebd9b39204d6a25928d45.jpg)](https://s2.51cto.com/oss/201904/08/791e10e8c82ebd9b39204d6a25928d45.jpg)

[![](https://s1.51cto.com/oss/201904/08/bad18c523394ec5b438432c89d5e2151.jpg)](https://s1.51cto.com/oss/201904/08/bad18c523394ec5b438432c89d5e2151.jpg)

吕老师：没错，在 Elasticsearch 中，节点是对等的，节点间会通过自己的一些规则选取集群的 Master，Master 会负责集群状态信息的改变，并同步给其他节点。

[![](https://s3.51cto.com/oss/201904/08/6430c3f1877dc02d57ad8cac34aee262.jpg)](https://s3.51cto.com/oss/201904/08/6430c3f1877dc02d57ad8cac34aee262.jpg)

[![](https://s3.51cto.com/oss/201904/08/24fbf36f0c0e533b3b4812ad2bc84112.jpg)](https://s3.51cto.com/oss/201904/08/24fbf36f0c0e533b3b4812ad2bc84112.jpg)

[![](https://s5.51cto.com/oss/201904/08/c7e182f296af1c801be8148761999f0e.jpg)](https://s5.51cto.com/oss/201904/08/c7e182f296af1c801be8148761999f0e.jpg)

[![](https://s1.51cto.com/oss/201904/08/f057a600234351c334200a1430cc658e.jpg)](https://s1.51cto.com/oss/201904/08/f057a600234351c334200a1430cc658e.jpg)

[![](https://s2.51cto.com/oss/201904/08/2c845be70c3e1855347320c111797266.jpg)](https://s2.51cto.com/oss/201904/08/2c845be70c3e1855347320c111797266.jpg)

吕老师：注意，只有建立索引和类型需要经过 Master，数据的写入有一个简单的 Routing 规则，可以 Route 到集群中的任意节点，所以数据写入压力是分散在整个集群的。

[![](https://s2.51cto.com/oss/201904/08/e744fc3420027c8892a7e533af8a45d5.jpg)](https://s2.51cto.com/oss/201904/08/e744fc3420027c8892a7e533af8a45d5.jpg)

**ELK 系统**

[![](https://s1.51cto.com/oss/201904/08/bf5c0f3c7042f764992ea0793f1f1377.jpg)](https://s1.51cto.com/oss/201904/08/bf5c0f3c7042f764992ea0793f1f1377.jpg)

[![](https://s3.51cto.com/oss/201904/08/f0f55f6e1c5b8b11a7e6bb1bf90b667c.jpg)](https://s3.51cto.com/oss/201904/08/f0f55f6e1c5b8b11a7e6bb1bf90b667c.jpg)

吕老师：其实很多公司都用 Elasticsearch 搭建 ELK 系统，也就是日志分析系统。其中 E 就是 Elasticsearch，L 是 Logstash，是一个日志收集系统，K 是 Kibana，是一个数据可视化平台。

[![](https://s3.51cto.com/oss/201904/08/2aac85380a65c7e31d96ec9e3d182e7c.jpg)](https://s3.51cto.com/oss/201904/08/2aac85380a65c7e31d96ec9e3d182e7c.jpg)

[![](https://s3.51cto.com/oss/201904/08/f3f9ca6d1ad35c6e840f1813cc34b126.jpg)](https://s3.51cto.com/oss/201904/08/f3f9ca6d1ad35c6e840f1813cc34b126.jpg)

[![](https://s3.51cto.com/oss/201904/08/a08908b776d84114b55bed778ab5fa0d.jpg)](https://s3.51cto.com/oss/201904/08/a08908b776d84114b55bed778ab5fa0d.jpg)

吕老师：分析日志的用处可大了，你想，假如一个分布式系统有 1000 台机器，系统出现故障时，我要看下日志，还得一台一台登录上去查看，是不是非常麻烦？

[![](https://s1.51cto.com/oss/201904/08/2bc46408b210b8c33e6d1393bca38af2.jpg)](https://s1.51cto.com/oss/201904/08/2bc46408b210b8c33e6d1393bca38af2.jpg)

[![](https://s2.51cto.com/oss/201904/08/4d3334f43df6c61b6d000631da674697.jpg)](https://s2.51cto.com/oss/201904/08/4d3334f43df6c61b6d000631da674697.jpg)

吕老师：但是如果日志接入了 ELK 系统就不一样。比如系统运行过程中，突然出现了异常，在日志中就能及时反馈，日志进入 ELK 系统中，我们直接在 Kibana 就能看到日志情况。如果再接入一些实时计算模块，还能做实时报警功能。

[![](https://s5.51cto.com/oss/201904/08/833fe4eb65e61be349ed24c8ca3f32fc.jpg)](https://s5.51cto.com/oss/201904/08/833fe4eb65e61be349ed24c8ca3f32fc.jpg)

[![](https://s4.51cto.com/oss/201904/08/2702813b66b8e93a3d6e2b38274c0b2a.jpg)](https://s4.51cto.com/oss/201904/08/2702813b66b8e93a3d6e2b38274c0b2a.jpg)

**总结**

小史学完了 Elasticsearch，在笔记本上写下了如下记录：

*   反向索引又叫倒排索引，是根据文章内容中的关键字建立索引。
*   搜索引擎原理就是建立反向索引。
*   Elasticsearch 在 Lucene 的基础上进行封装，实现了分布式搜索引擎。
*   Elasticsearch 中的索引、类型和文档的概念比较重要，类似于 MySQL 中的数据库、表和行。
*   Elasticsearch 也是 Master-slave 架构，也实现了数据的分片和备份。
*   Elasticsearch 一个典型应用就是 ELK 日志分析系统。

写完，又高高兴兴背诗去了。

观书有感（朱熹）

半亩方塘一鉴开，天光云影共徘徊。

问渠那得清如许？为有源头活水来。

[![](https://s2.51cto.com/oss/201909/02/06b2a54c97a0c09401603bab7aea68d4.gif-wh_600x-s_2946624692.gif)](https://s2.51cto.com/oss/201909/02/06b2a54c97a0c09401603bab7aea68d4.gif-wh_600x-s_2946624692.gif)

【编辑推荐】

【责任编辑：[武晓燕](mailto:sunsj@51cto.com) TEL：（010）68476606】

[点赞 0](###)